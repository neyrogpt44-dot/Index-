<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>SGSHOP138 | –ö—Ä–æ—Å—Å–æ–≤–∫–∏ –∏ –û–¥–µ–∂–¥–∞</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --fire: #ff0000; --bg: #000; --card-bg: #080808; --border: #1a1a1a; --text: #fff; }
        * { box-sizing: border-box; }
        body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; margin: 0; padding-top: 80px; }

        /* --- FIREBOX HEADER --- */
        header { position: fixed; top: 0; width: 100%; height: 80px; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); z-index: 1000; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 40px; }
        .logo img { height: 35px; }
        .nav-center { display: flex; gap: 30px; }
        .nav-link { text-transform: uppercase; font-size: 12px; font-weight: 700; cursor: pointer; color: #888; transition: 0.3s; }
        .nav-link:hover, .nav-link.active { color: #fff; }
        
        /* --- CONTROLS BAR --- */
        .controls-bar { max-width: 1440px; margin: 0 auto; padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); }
        .filter-trigger { background: var(--fire); color: #fff; padding: 10px 25px; font-weight: 800; text-transform: uppercase; font-size: 11px; cursor: pointer; border: none; }
        .grid-switcher { display: flex; gap: 10px; align-items: center; }
        .grid-switcher span { color: #444; font-size: 11px; font-weight: 800; }
        .grid-btn { width: 30px; height: 30px; border: 1px solid #333; background: none; color: #fff; cursor: pointer; }
        .grid-btn.active { border-color: var(--fire); color: var(--fire); }

        /* --- PRODUCT GRID SYSTEM --- */
        .main-container { display: flex; max-width: 1440px; margin: 0 auto; padding: 0 40px; }
        
        .sidebar { width: 250px; padding: 40px 0; flex-shrink: 0; }
        .filter-group { margin-bottom: 30px; }
        .filter-label { font-size: 14px; font-weight: 900; text-transform: uppercase; margin-bottom: 15px; display: block; }
        .filter-item { color: #888; font-size: 13px; margin-bottom: 8px; cursor: pointer; display: block; }
        .filter-item:hover { color: #fff; }

        .content { flex-grow: 1; padding: 40px 0 40px 40px; }
        .catalog { display: grid; gap: 20px; transition: 0.3s; }
        
        /* –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–µ—Ç–∫–∏ */
        .grid-4 { grid-template-columns: repeat(4, 1fr); }
        .grid-2 { grid-template-columns: repeat(2, 1fr); }

        /* --- PRODUCT CARD --- */
        .card { background: var(--card-bg); border: 1px solid var(--border); transition: 0.4s cubic-bezier(0.165, 0.84, 0.44, 1); position: relative; }
        .card:hover { transform: translateY(-5px); border-color: #333; }
        .card-img { aspect-ratio: 1/1.1; display: flex; align-items: center; justify-content: center; padding: 30px; overflow: hidden; }
        .card-img img { max-width: 100%; transition: 0.5s; }
        .card:hover .card-img img { transform: scale(1.1); }
        
        .card-info { padding: 20px; border-top: 1px solid var(--border); }
        .card-brand { font-size: 10px; color: var(--fire); font-weight: 900; text-transform: uppercase; margin-bottom: 5px; }
        .card-name { font-size: 14px; color: #eee; height: 40px; overflow: hidden; line-height: 1.4; margin-bottom: 15px; }
        .card-footer { display: flex; justify-content: space-between; align-items: center; }
        .price { font-size: 20px; font-weight: 900; }
        .add-btn { width: 35px; height: 35px; background: #fff; color: #000; border: none; font-weight: 900; cursor: pointer; }

        /* --- CART SIDEBAR --- */
        .cart-panel { position: fixed; right: -100%; top: 0; width: 450px; height: 100%; background: #000; z-index: 2000; transition: 0.5s; border-left: 1px solid var(--border); padding: 40px; display: flex; flex-direction: column; }
        .cart-panel.active { right: 0; }
        .cart-header { font-size: 24px; font-weight: 900; margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 20px; }
        .cart-items { flex-grow: 1; overflow-y: auto; }
        .checkout-btn { background: var(--fire); color: #fff; width: 100%; padding: 20px; border: none; font-weight: 900; cursor: pointer; margin-top: 20px; }

        @media (max-width: 1024px) {
            .sidebar { display: none; }
            .content { padding: 20px 0; }
            .grid-4 { grid-template-columns: repeat(2, 1fr); }
            header { padding: 0 20px; }
            .controls-bar { padding: 20px; }
            .cart-panel { width: 100%; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo"><img src="santa.png"></div>
        <div class="nav-center">
            <div class="nav-link active">–ö–∞—Ç–∞–ª–æ–≥</div>
            <div class="nav-link">–ú—É–∂—Å–∫–æ–µ</div>
            <div class="nav-link">–ñ–µ–Ω—Å–∫–æ–µ</div>
            <div class="nav-link">Sale</div>
        </div>
        <div class="nav-right" onclick="toggleCart()" style="cursor:pointer">
            üõí <span id="cart-counter" style="background:var(--fire); padding:2px 6px; border-radius:10px; font-size:10px;">0</span>
        </div>
    </header>

    <div class="controls-bar">
        <button class="filter-trigger">–§–∏–ª—å—Ç—Ä—ã</button>
        <div class="grid-switcher">
            <span>–°–ï–¢–ö–ê</span>
            <button class="grid-btn active" onclick="setGrid(4, this)">4</button>
            <button class="grid-btn" onclick="setGrid(2, this)">2</button>
        </div>
    </div>

    <div class="main-container">
        <aside class="sidebar">
            <div class="filter-group">
                <span class="filter-label">–ë—Ä–µ–Ω–¥—ã</span>
                <div class="filter-item" onclick="filter('Nike')">Nike</div>
                <div class="filter-item" onclick="filter('Adidas')">Adidas</div>
                <div class="filter-item" onclick="filter('Jordan')">Jordan</div>
                <div class="filter-item" onclick="filter('New Balance')">New Balance</div>
            </div>
            <div class="filter-group">
                <span class="filter-label">–¶–µ–Ω–∞</span>
                <div class="filter-item" onclick="sort('asc')">–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</div>
                <div class="filter-item" onclick="sort('desc')">–ü–æ —É–±—ã–≤–∞–Ω–∏—é</div>
            </div>
        </aside>

        <main class="content">
            <div class="catalog grid-4" id="catalog-grid">
                </div>
        </main>
    </div>

    <div class="cart-panel" id="cart-panel">
        <div class="cart-header">–ö–û–†–ó–ò–ù–ê <span onclick="toggleCart()" style="float:right; cursor:pointer">‚úï</span></div>
        <div class="cart-items" id="cart-list"></div>
        <div id="total-sum" style="font-size: 22px; font-weight: 900; padding: 20px 0;">–ò—Ç–æ–≥–æ: 0 ‚ÇΩ</div>
        <button class="checkout-btn" onclick="order()">–û–§–û–†–ú–ò–¢–¨ –í TELEGRAM</button>
    </div>

    <script>
        let products = [];
        let cart = [];

        async function load() {
            const res = await fetch('/api/get');
            const text = await res.text();
            const xml = new DOMParser().parseFromString(text, "text/xml");
            products = Array.from(xml.querySelectorAll("offer")).map(el => ({
                id: el.getAttribute('id'),
                name: el.querySelector("name")?.textContent,
                price: parseInt(el.querySelector("price")?.textContent),
                img: el.querySelector("picture")?.textContent
            }));
            render(products);
        }

        function render(data) {
            document.getElementById('catalog-grid').innerHTML = data.map(p => `
                <div class="card">
                    <div class="card-img"><img src="${p.img}" loading="lazy"></div>
                    <div class="card-info">
                        <div class="card-brand">Official Store</div>
                        <div class="card-name">${p.name}</div>
                        <div class="card-footer">
                            <div class="price">${p.price.toLocaleString()} ‚ÇΩ</div>
                            <button class="add-btn" onclick="addToCart('${p.id}')">+</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function setGrid(num, btn) {
            const grid = document.getElementById('catalog-grid');
            document.querySelectorAll('.grid-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            grid.className = `catalog grid-${num}`;
        }

        function addToCart(id) {
            const p = products.find(x => x.id === id);
            cart.push(p);
            updateCart();
            toggleCart(true);
        }

        function updateCart() {
            document.getElementById('cart-counter').innerText = cart.length;
            let total = 0;
            document.getElementById('cart-list').innerHTML = cart.map((p, i) => {
                total += p.price;
                return `<div style="display:flex; gap:15px; margin-bottom:20px; background:#111; padding:10px;">
                    <img src="${p.img}" style="width:60px;">
                    <div>
                        <div style="font-size:11px;">${p.name}</div>
                        <div style="font-weight:900;">${p.price} ‚ÇΩ</div>
                    </div>
                </div>`;
            }).join('');
            document.getElementById('total-sum').innerText = `–ò—Ç–æ–≥–æ: ${total.toLocaleString()} ‚ÇΩ`;
        }

        function toggleCart(open = false) {
            document.getElementById('cart-panel').classList.toggle('active', open);
        }

        function filter(brand) {
            const filtered = products.filter(p => p.name.includes(brand));
            render(filtered);
        }

        function sort(type) {
            const sorted = [...products].sort((a,b) => type === 'asc' ? a.price - b.price : b.price - a.price);
            render(sorted);
        }

        function order() {
            if(!cart.length) return;
            let msg = "–ó–∞–∫–∞–∑:\n";
            cart.forEach(p => msg += `- ${p.name} (${p.price}‚ÇΩ)\n`);
            window.open(`https://t.me/–¢–í–û–ô_–ù–ò–ö?text=${encodeURIComponent(msg)}`);
        }

        load();
    </
